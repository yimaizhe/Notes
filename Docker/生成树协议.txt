 生成树协议是如何工作的？         1.当路由器打开的时候，所有的端口都处于Listening状态，每个网桥都会认为自己是根网桥，然后都每隔两秒就向外发送一次自己的BPDU，如果收到的BPDU的BID比自己的小，则停止转发自己的BPDU，开始转发更优的BPDU，如果比自己的BID大或者和自己的BID相等，则丢弃该BPDU。等到都扩散完毕之后开始各项的选举，这时候每个BID最小的网桥成了根网桥，各个网桥通过收到的BPDU来确定根端口和指定端口。首先看COST值，然后再看邻居的BID，再然后看对端端口的PID，指定端口也首先看COST，然后看两端网桥的BID。剩下的成为非指定端口，转到blocking状态。这个状态总共持续15s（转发延迟），之后进入learning状态。   2， 这里有个网络直径的概念，默认是7，在15秒之内BPDU差不多可以传给每一个网桥，这个数值不建议随便改，改大了的话会使收敛时间变久，改小的话虽然可以缩短收敛时间，但是如果数值小雨网络的实际规模，会使BPDU的传播不完全，后果不堪设想。        
3.进入Learning状态之后，填写MAC地址表，经过15s（转发延迟）之后进入Forwarding状态。        
4.进入Forwarding状态之后，开始转发数据，并且同时接受转发来自于根的BPDU，维护拓扑。这时只有根网桥发BPDU，其他网桥都只是转发BPDU。
5.当一个新的网桥加入的时候，端口状态是Learning，新的交换机认为自己是根网桥开始发送BPDU，也接收对端的BPDU，然后进行进行进一步的竞选，若竞选成功，则网络格局就重新变化了，造成网络断开，若竞选失败则计算根端口指定端口和非指定端口。（30s可以完成）
6.若拓扑中有线路断开，则分为两种情况（TCN从根端口向上传，从指定端口向下传，并且需要一层层的确认） 